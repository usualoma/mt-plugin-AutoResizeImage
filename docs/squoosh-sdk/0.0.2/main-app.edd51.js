(self.webpackJsonp=self.webpackJsonp||[]).push([[0],Array(19).concat([function(t,e,n){"use strict";function o(t,e){for(const n in t)if(t[n]!==e[n])return!1;for(const n in e)if(!(n in t))return!1;return!0}function i(t,e){const n=t.getContext("2d");if(!n)throw Error("Canvas not initialized");n.clearRect(0,0,t.width,t.height),n.putImageData(e,0,0)}async function s(t,e,n){const o=document.createElement("canvas");o.width=t.width,o.height=t.height;const i=o.getContext("2d");if(!i)throw Error("Canvas not initialized");let s;if(i.putImageData(t,0,0),"toBlob"in o)s=await new Promise(t=>o.toBlob(t,e,n));else{const t=o.toDataURL(e,n),i=/data:([^;]+);base64,(.*)$/.exec(t);if(!i)throw Error("Data URL reading failed");const r=i[1],a=atob(i[2]),c=new Uint8Array(a.length);for(let e=0;e<c.length;e+=1)c[e]=a.charCodeAt(e);s=new Blob([c],{type:r})}if(!s)throw Error("Encoding failed");return s}async function r(t){const e=new Image;e.decoding="async",e.src=t;const n=new Promise((t,n)=>{e.onload=()=>t(),e.onerror=()=>n(Error("Image loading error"))});return e.decode&&await e.decode().catch(()=>null),await n,e}function a(t){return r(t).then(()=>!0,()=>!1)}function c(t){return new Response(t).arrayBuffer()}function l(t){return new Response(t).text()}n.d(e,"p",function(){return o}),n.d(e,"f",function(){return i}),n.d(e,"e",function(){return s}),n.d(e,"d",function(){return a}),n.d(e,"a",function(){return c}),n.d(e,"c",function(){return l}),n.d(e,"q",function(){return u}),n.d(e,"b",function(){return p}),n.d(e,"g",function(){return d}),n.d(e,"m",function(){return b}),n.d(e,"n",function(){return g}),n.d(e,"k",function(){return f}),n.d(e,"i",function(){return m}),n.d(e,"h",function(){return v}),n.d(e,"j",function(){return O}),n.d(e,"l",function(){return y}),n.d(e,"r",function(){return _}),n.d(e,"o",function(){return j});const h=new Map([[/^%PDF-/,"application/pdf"],[/^GIF87a/,"image/gif"],[/^GIF89a/,"image/gif"],[/^\x89PNG\x0D\x0A\x1A\x0A/,"image/png"],[/^\xFF\xD8\xFF/,"image/jpeg"],[/^BM/,"image/bmp"],[/^I I/,"image/tiff"],[/^II*/,"image/tiff"],[/^MM\x00*/,"image/tiff"],[/^RIFF....WEBPVP8[LX ]/,"image/webp"]]);async function u(t){const e=await c(t.slice(0,16)),n=Array.from(new Uint8Array(e)).map(t=>String.fromCodePoint(t)).join("");for(const[o,i]of h)if(o.test(n))return i;return""}async function p(t){const e=URL.createObjectURL(t);try{return await r(e)}finally{URL.revokeObjectURL(e)}}function d(t,e={}){const{width:n=t.width,height:o=t.height,sx:i=0,sy:s=0,sw:r=t.width,sh:a=t.height}=e,c=document.createElement("canvas");c.width=n,c.height=o;const l=c.getContext("2d");if(!l)throw new Error("Could not create canvas context");return l.drawImage(t,i,s,r,a,0,0,n,o),l.getImageData(0,0,n,o)}async function b(t){return d("createImageBitmap"in self?await createImageBitmap(t):await p(t))}function g(t,e,n,o,s,r,a,c){const l=document.createElement("canvas");l.width=t.width,l.height=t.height,i(l,t);const h=document.createElement("canvas");h.width=r,h.height=a;const u=h.getContext("2d");if(!u)throw new Error("Could not create canvas context");return"pixelated"===c?u.imageSmoothingEnabled=!1:u.imageSmoothingQuality=c,u.drawImage(l,e,n,o,s,0,0,r,a),u.getImageData(0,0,r,a)}function f(t,e=0){return t?Number(O(t)):e}function m(t,e=0){return t?Number(v(t)):e}function v(t,e=!1){return t?t.checked:e}function O(t,e=""){return t?t.value:e}function y(){return new Promise(t=>{let e="";const n=o=>{"38384040373937396665"===(e=(e+=o.keyCode).slice(-"38384040373937396665".length))&&(window.removeEventListener("keydown",n),t())};window.addEventListener("keydown",n)})}async function _(t,e){const{from:n=t.getBoundingClientRect().height,to:o=t.getBoundingClientRect().height,duration:i=1e3,easing:s="ease-in-out"}=e;if(n!==o&&0!==i)return t.style.height=n+"px",getComputedStyle(t).transform,t.style.transition=`height ${i}ms ${s}`,t.style.height=o+"px",new Promise(e=>{const n=o=>{o.target===t&&(t.style.transition="",t.removeEventListener("transitionend",n),t.removeEventListener("transitioncancel",n),e())};t.addEventListener("transitionend",n),t.addEventListener("transitioncancel",n)});t.style.height=o+"px"}function j(t){t.preventDefault()}},function(t,e,n){t.exports={"options-title":"_bowx",optionsTitle:"_bowx","option-text-first":"_22nOp",optionTextFirst:"_22nOp","option-one-cell":"_3bqd9",optionOneCell:"_3bqd9","option-input-first":"_41Z3W",optionInputFirst:"_41Z3W","section-enabler":"_2bLMv",sectionEnabler:"_2bLMv","options-section":"_2O8o1",optionsSection:"_2O8o1","text-field":"YOpk9",textField:"YOpk9","options-scroller":"HlR3l",optionsScroller:"HlR3l"}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n(19);async function i(t){try{const n=await Object(o.e)(new ImageData(1,1),t);return!!n&&n.type===t}catch(e){return!1}}},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return o}),n.d(e,"label",function(){return i}),n.d(e,"mimeType",function(){return s}),n.d(e,"extension",function(){return r}),n.d(e,"defaultOptions",function(){return a});const o="browser-png",i="Browser PNG",s="image/png",r="png",a={}},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return o}),n.d(e,"label",function(){return i}),n.d(e,"mimeType",function(){return s}),n.d(e,"extension",function(){return r}),n.d(e,"defaultOptions",function(){return a});const o="browser-jpeg",i="Browser JPEG",s="image/jpeg",r="jpg",a={quality:.75}},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return i}),n.d(e,"label",function(){return s}),n.d(e,"mimeType",function(){return r}),n.d(e,"extension",function(){return a}),n.d(e,"defaultOptions",function(){return c}),n.d(e,"featureTest",function(){return l});var o=n(21);const i="browser-webp",s="Browser WebP",r="image/webp",a="webp",c={quality:.75},l=()=>Object(o.a)(r)},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return i}),n.d(e,"label",function(){return s}),n.d(e,"mimeType",function(){return r}),n.d(e,"extension",function(){return a}),n.d(e,"defaultOptions",function(){return c}),n.d(e,"featureTest",function(){return l});var o=n(21);const i="browser-gif",s="Browser GIF",r="image/gif",a="gif",c={},l=()=>Object(o.a)(r)},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return i}),n.d(e,"label",function(){return s}),n.d(e,"mimeType",function(){return r}),n.d(e,"extension",function(){return a}),n.d(e,"defaultOptions",function(){return c}),n.d(e,"featureTest",function(){return l});var o=n(21);const i="browser-tiff",s="Browser TIFF",r="image/tiff",a="tiff",c={},l=()=>Object(o.a)(r)},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return i}),n.d(e,"label",function(){return s}),n.d(e,"mimeType",function(){return r}),n.d(e,"extension",function(){return a}),n.d(e,"defaultOptions",function(){return c}),n.d(e,"featureTest",function(){return l});var o=n(21);const i="browser-jp2",s="Browser JPEG 2000",r="image/jp2",a="jp2",c={},l=()=>Object(o.a)(r)},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return i}),n.d(e,"label",function(){return s}),n.d(e,"mimeType",function(){return r}),n.d(e,"extension",function(){return a}),n.d(e,"defaultOptions",function(){return c}),n.d(e,"featureTest",function(){return l});var o=n(21);const i="browser-bmp",s="Browser BMP",r="image/bmp",a="bmp",c={},l=()=>Object(o.a)(r)},function(t,e,n){"use strict";n.r(e),n.d(e,"type",function(){return i}),n.d(e,"label",function(){return s}),n.d(e,"mimeType",function(){return r}),n.d(e,"extension",function(){return a}),n.d(e,"defaultOptions",function(){return c}),n.d(e,"featureTest",function(){return l});var o=n(21);const i="browser-pdf",s="Browser PDF",r="application/pdf",a="pdf",c={},l=()=>Object(o.a)(r)},function(t,e,n){t.exports={"two-up-handle":"fKaHr",twoUpHandle:"fKaHr",scrubber:"_1N4rr"}},function(t,e,n){"use strict";n.d(e,"b",function(){return l}),n.d(e,"a",function(){return h});const o=Symbol("comlinkProxyValue"),i=["ArrayBuffer","MessagePort","OffscreenCanvas"].filter(t=>t in self).map(t=>self[t]),s=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),r=Symbol("throw"),a=new Map([["PROXY",{canHandle:t=>!!t&&!0===t[o],serialize:t=>{const{port1:e,port2:n}=new MessageChannel;return h(t,e),n},deserialize:t=>l(t)}],["THROW",{canHandle:t=>t&&t[r],serialize:t=>{const e=t&&t.message,n=t&&t.stack;return Object.assign({},t,{message:e,stack:n})},deserialize:t=>{throw Object.assign(Error(),t)}}]]);let c=0;function l(t,e){if(v(t)&&(t=b(t)),!g(t))throw Error("endpoint does not have all of addEventListener, removeEventListener and postMessage defined");return f(t),function t(e,n=[],o=function(){}){return new Proxy(o,{construct:(t,o,i)=>e({type:"CONSTRUCT",callPath:n,argumentsList:o}),apply:(o,i,s)=>"bind"===n[n.length-1]?t(e,n.slice(0,-1)):e({type:"APPLY",callPath:n,argumentsList:s}),get(o,i,s){if("then"===i&&0===n.length)return{then:()=>s};if("then"===i){const t=e({type:"GET",callPath:n});return Promise.resolve(t).then.bind(t)}return t(e,n.concat(i),o[i])},set:(t,o,i,s)=>e({type:"SET",callPath:n,property:o,value:i})})}(async e=>{let n=[];return"APPLY"!==e.type&&"CONSTRUCT"!==e.type||(n=e.argumentsList.map(u)),p((await function(t,e,n){const o=`${s}-${c++}`;return new Promise(i=>{m(t,function e(n){n.data.id===o&&(!function(t,e){t.removeEventListener("message",e)}(t,e),i(n))}),e=Object.assign({},e,{id:o}),t.postMessage(e,n)})}(t,Object.assign({},e,{argumentsList:n}),_(n))).data.value)},[],e)}function h(t,e){if(v(e)&&(e=b(e)),!g(e))throw Error("endpoint does not have all of addEventListener, removeEventListener and postMessage defined");f(e),m(e,async function(n){if(!n.data.id||!n.data.callPath)return;const i=n.data;let s=await i.callPath.slice(0,-1).reduce((t,e)=>t[e],t),c=await i.callPath.reduce((t,e)=>t[e],t),l=c,h=[];if("APPLY"!==i.type&&"CONSTRUCT"!==i.type||(h=i.argumentsList.map(p)),"APPLY"===i.type)try{l=await c.apply(s,h)}catch(u){(l=u)[r]=!0}if("CONSTRUCT"===i.type)try{l=function(t){const e=t;return e[o]=!0,e}(l=new c(...h))}catch(u){(l=u)[r]=!0}return"SET"===i.type&&(c[i.property]=i.value,l=!0),(l=function(t){for(const[e,n]of a)if(n.canHandle(t)){const o=n.serialize(t);return{value:{type:e,value:o}}}return{value:{type:"RAW",value:t}}}(l)).id=i.id,e.postMessage(l,_([l]))})}function u(t){for(const[n,o]of a)if(o.canHandle(t))return{type:n,value:o.serialize(t)};let e=[];for(const n of y(t))for(const[t,o]of a)o.canHandle(n.value)&&e.push({path:n.path,wrappedValue:{type:t,value:o.serialize(n.value)}});for(const n of e){n.path.slice(0,-1).reduce((t,e)=>t[e],t)[n.path[n.path.length-1]]=null}return{type:"RAW",value:t,wrappedChildren:e}}function p(t){if(a.has(t.type)){return a.get(t.type).deserialize(t.value)}if(function(t){return"RAW"===t.type}(t)){for(const e of t.wrappedChildren||[]){if(!a.has(e.wrappedValue.type))throw Error(`Unknown value type "${t.type}" at ${e.path.join(".")}`);const n=a.get(e.wrappedValue.type).deserialize(e.wrappedValue.value);d(t.value,e.path,n)}return t.value}throw Error(`Unknown value type "${t.type}"`)}function d(t,e,n){const o=e.slice(-1)[0];e.slice(0,-1).reduce((t,e)=>t[e],t)[o]=n}function b(t){if("Window"!==self.constructor.name)throw Error("self is not a window");return{addEventListener:self.addEventListener.bind(self),removeEventListener:self.removeEventListener.bind(self),postMessage:(e,n)=>t.postMessage(e,"*",n)}}function g(t){return"addEventListener"in t&&"removeEventListener"in t&&"postMessage"in t}function f(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.start()}function m(t,e){t.addEventListener("message",e)}function v(t){return["window","length","location","parent","opener"].every(e=>e in t)}function O(t){return i.some(e=>t instanceof e)}function*y(t,e=[],n=null){if(!t)return;if(n||(n=new WeakSet),n.has(t))return;if("string"==typeof t)return;if("object"==typeof t&&n.add(t),ArrayBuffer.isView(t))return;yield{value:t,path:e};const o=Object.keys(t);for(const i of o)yield*y(t[i],[...e,i],n)}function _(t){const e=[];for(const n of y(t))O(n.value)&&e.push(n.value);return e}},function(t,e,n){t.exports={results:"_2Za09","result-data":"hc73a",resultData:"hc73a","download-right":"_3XDaq",downloadRight:"_3XDaq","download-left":"_1wmPh",downloadLeft:"_1wmPh","stack-right":"_2I565",stackRight:"_2I565","result-title":"_3ikiG",resultTitle:"_3ikiG","size-delta":"_1eNmr",sizeDelta:"_1eNmr","size-increase":"_21jT-",sizeIncrease:"_21jT-","size-decrease":"_1U8bE",sizeDecrease:"_1U8bE",download:"_1Lw5i","download-link":"_2pDQm",downloadLink:"_2pDQm","action-enter":"_1EMMz",actionEnter:"_1EMMz","download-link-disable":"yznmM",downloadLinkDisable:"yznmM","action-leave":"_1udtV",actionLeave:"_1udtV","download-icon":"_1bBjU",downloadIcon:"_1bBjU","copy-icon":"_9VG14",copyIcon:"_9VG14",spinner:"_2EVrV","copy-to-other":"_1BPNG LdCmd _1Lw5i",copyToOther:"_1BPNG LdCmd _1Lw5i"}},function(t,e,n){t.exports={compress:"_2wucw",options:"_1vnTp","multi-panel":"_1iYR2",multiPanel:"_1iYR2","expand-icon":"qUjf-",expandIcon:"qUjf-"}},function(t,e,n){},function(t,e,n){t.exports={output:"_3wY6x _2H7gL","alt-background":"_2SEwr",altBackground:"_2SEwr","two-up":"_367Xl _2H7gL",twoUp:"_367Xl _2H7gL","pinch-zoom":"_1Bd5a _2H7gL",pinchZoom:"_1Bd5a _2H7gL","pinch-target":"_3P3SZ",pinchTarget:"_3P3SZ",controls:"_3YuEs","zoom-controls":"_17ipg",zoomControls:"_17ipg",button:"_2snFQ",zoom:"_2mErH",active:"lb8rE","zoom-value":"_1FTAH",zoomValue:"_1FTAH",back:"_2_rma","buttons-no-wrap":"_1BEC8",buttonsNoWrap:"_1BEC8"}},function(t,e,n){t.exports={range:"QqOS4","label-text":"_3hiaw",labelText:"_3hiaw","range-wc-container":"_15Ptg",rangeWcContainer:"_15Ptg","range-wc":"_1grfT",rangeWc:"_1grfT","text-input":"nPuUh",textInput:"nPuUh"}},function(t,e,n){t.exports={input:"_2x7lc",thumb:"_1gtTt","thumb-wrapper":"hL76v",thumbWrapper:"hL76v","value-display":"_3JmdS",valueDisplay:"_3JmdS","touch-active":"_3dAl-",touchActive:"_3dAl-"}},function(t,e,n){t.exports={checkbox:"_3LmVE","real-checkbox":"hoUbY",realCheckbox:"hoUbY",icon:"K0_Fo",checked:"_2njZE"}},function(t,e,n){t.exports={"children-exiting":"_3Jzxx",childrenExiting:"_3Jzxx"}},function(t,e,n){t.exports={select:"_1Xahn","native-select":"rBT9o",nativeSelect:"rBT9o",arrow:"fbftt",large:"_19hmM"}},function(t,e){t.exports="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return m});var o=n(31),i=n(19),s=n(56),r=n(44),a=n(45),c=n(46),l=n(47),h=n(48),u=n(49),p=n(50),d=n(51),b=n(2),g=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};const f=1e4;class m{constructor(){this._busy=!1,this._latestJobId=0,this._workerTimeoutId=0}static _processingJob(e={}){const{needsWorker:n=!1}=e;return(e,i,s)=>{const r=s.value;s.value=async function(...e){this._latestJobId+=1;const i=this._latestJobId;this.abortCurrent(),n&&self.clearTimeout(this._workerTimeoutId),!this._worker&&n&&(this._worker=new Worker(t,{name:"processor-worker"}),this._workerApi=Object(o.b)(this._worker)),this._busy=!0;const s=Promise.race([r.call(this,...e),new Promise((t,e)=>{this._abortRejector=e})]);return await s.catch(()=>{}),i===this._latestJobId&&this._jobCleanup(),s}}}_jobCleanup(){this._busy=!1,this._worker&&(this._workerTimeoutId=self.setTimeout(this.terminateWorker,f))}abortCurrent(){if(this._busy){if(!this._abortRejector)throw Error("There must be a rejector if it's busy");this._abortRejector(new DOMException("Aborted","AbortError")),this._abortRejector=void 0,this._busy=!1,this.terminateWorker()}}terminateWorker(){this._worker&&(this._worker.terminate(),this._worker=void 0)}imageQuant(t,e){return this._workerApi.quantize(t,e)}rotate(t,e){return this._workerApi.rotate(t,e)}workerResize(t,e){return this._workerApi.resize(t,e)}mozjpegEncode(t,e){return this._workerApi.mozjpegEncode(t,e)}async optiPngEncode(t,e){const n=await Object(i.e)(t,"image/png"),o=await Object(i.a)(n);return this._workerApi.optiPngEncode(o,e)}webpEncode(t,e){return this._workerApi.webpEncode(t,e)}async webpDecode(t){const e=await Object(i.a)(t);return this._workerApi.webpDecode(e)}browserBmpEncode(t){return r.a(t)}browserPngEncode(t){return a.a(t)}browserJpegEncode(t,e){return c.a(t,e)}browserWebpEncode(t,e){return l.a(t,e)}browserGifEncode(t){return h.a(t)}browserTiffEncode(t){return u.a(t)}browserJp2Encode(t){return p.a(t)}browserPdfEncode(t){return d.a(t)}resize(t,e){return this.abortCurrent(),Object(s.a)(t,e)}vectorResize(t,e){return this.abortCurrent(),Object(s.b)(t,e)}}g([b.b],m.prototype,"terminateWorker",null),g([m._processingJob({needsWorker:!0})],m.prototype,"imageQuant",null),g([m._processingJob({needsWorker:!0})],m.prototype,"rotate",null),g([m._processingJob({needsWorker:!0})],m.prototype,"workerResize",null),g([m._processingJob({needsWorker:!0})],m.prototype,"mozjpegEncode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"optiPngEncode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"webpEncode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"webpDecode",null),g([m._processingJob()],m.prototype,"browserBmpEncode",null),g([m._processingJob()],m.prototype,"browserPngEncode",null),g([m._processingJob()],m.prototype,"browserJpegEncode",null),g([m._processingJob()],m.prototype,"browserWebpEncode",null),g([m._processingJob()],m.prototype,"browserGifEncode",null),g([m._processingJob()],m.prototype,"browserTiffEncode",null),g([m._processingJob()],m.prototype,"browserJp2Encode",null),g([m._processingJob()],m.prototype,"browserPdfEncode",null)}).call(this,n(43))},function(t,e,n){t.exports=n.p+"processor-worker.63a04.worker.js"},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(28),i=n(19);function s(t){return Object(i.e)(t,o.mimeType)}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(22),i=n(19);function s(t){return Object(i.e)(t,o.mimeType)}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(23),i=n(19);function s(t,{quality:e}){return Object(i.e)(t,o.mimeType,e)}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(24),i=n(19);function s(t,{quality:e}){return Object(i.e)(t,o.mimeType,e)}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(25),i=n(19);function s(t){return Object(i.e)(t,o.mimeType)}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(26),i=n(19);function s(t){return Object(i.e)(t,o.mimeType)}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(27),i=n(19);function s(t){return Object(i.e)(t,o.mimeType)}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(29),i=n(19);function s(t){return Object(i.e)(t,o.mimeType)}},function(t,e,n){t.exports={"panel-heading":"ED-CD",panelHeading:"ED-CD","panel-content":"_10baD",panelContent:"_10baD"}},function(t,e,n){"use strict";const o=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],i=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=(t,e)=>{let n=t;return"string"==typeof e?n=t.toLocaleString(e):!0===e&&(n=t.toLocaleString()),n};t.exports=(t,e)=>{if(!Number.isFinite(t))throw new TypeError(`Expected a finite number, got ${typeof t}: ${t}`);const n=(e=Object.assign({bits:!1},e)).bits?i:o;if(e.signed&&0===t)return" 0 "+n[0];const r=t<0,a=r?"-":e.signed?"+":"";if(r&&(t=-t),t<1){return a+s(t,e.locale)+" "+n[0]}const c=Math.min(Math.floor(Math.log10(t)/3),n.length-1);return t=Number((t/Math.pow(1e3,c)).toPrecision(3)),a+s(t,e.locale)+" "+n[c]}},,function(t,e,n){"use strict";n.r(e);var o={};n.r(o),n.d(o,"MozJpegColorSpace",function(){return ot}),n.d(o,"type",function(){return at}),n.d(o,"label",function(){return ct}),n.d(o,"mimeType",function(){return lt}),n.d(o,"extension",function(){return ht}),n.d(o,"defaultOptions",function(){return ut});var i={};n.r(i),n.d(i,"WebPImageHint",function(){return wt}),n.d(i,"type",function(){return Et}),n.d(i,"label",function(){return xt}),n.d(i,"mimeType",function(){return Pt}),n.d(i,"extension",function(){return St}),n.d(i,"defaultOptions",function(){return kt});var s={};n.r(s),n.d(s,"type",function(){return Ut}),n.d(s,"label",function(){return $t}),n.d(s,"defaultOptions",function(){return Nt});var r={};n.r(r),n.d(r,"type",function(){return Vt}),n.d(r,"label",function(){return Yt}),n.d(r,"mimeType",function(){return Gt}),n.d(r,"extension",function(){return Jt}),n.d(r,"defaultOptions",function(){return Zt});var a=n(0),c=n(2),l=n(19),h=n(33);class u{constructor(t){this.id=-1,this.nativePointer=t,this.pageX=t.pageX,this.pageY=t.pageY,this.clientX=t.clientX,this.clientY=t.clientY,self.Touch&&t instanceof Touch?this.id=t.identifier:p(t)&&(this.id=t.pointerId)}getCoalesced(){return"getCoalescedEvents"in this.nativePointer?this.nativePointer.getCoalescedEvents().map(t=>new u(t)):[this]}}const p=t=>self.PointerEvent&&t instanceof PointerEvent,d=()=>{};var b=class{constructor(t,e){this._element=t,this.startPointers=[],this.currentPointers=[];const{start:n=(()=>!0),move:o=d,end:i=d}=e;this._startCallback=n,this._moveCallback=o,this._endCallback=i,this._pointerStart=this._pointerStart.bind(this),this._touchStart=this._touchStart.bind(this),this._move=this._move.bind(this),this._triggerPointerEnd=this._triggerPointerEnd.bind(this),this._pointerEnd=this._pointerEnd.bind(this),this._touchEnd=this._touchEnd.bind(this),self.PointerEvent?this._element.addEventListener("pointerdown",this._pointerStart):(this._element.addEventListener("mousedown",this._pointerStart),this._element.addEventListener("touchstart",this._touchStart),this._element.addEventListener("touchmove",this._move),this._element.addEventListener("touchend",this._touchEnd))}_triggerPointerStart(t,e){return!!this._startCallback(t,e)&&(this.currentPointers.push(t),this.startPointers.push(t),!0)}_pointerStart(t){0===t.button&&this._triggerPointerStart(new u(t),t)&&(p(t)?(this._element.setPointerCapture(t.pointerId),this._element.addEventListener("pointermove",this._move),this._element.addEventListener("pointerup",this._pointerEnd)):(window.addEventListener("mousemove",this._move),window.addEventListener("mouseup",this._pointerEnd)))}_touchStart(t){for(const e of Array.from(t.changedTouches))this._triggerPointerStart(new u(e),t)}_move(t){const e=this.currentPointers.slice(),n="changedTouches"in t?Array.from(t.changedTouches).map(t=>new u(t)):[new u(t)],o=[];for(const i of n){const t=this.currentPointers.findIndex(t=>t.id===i.id);-1!==t&&(o.push(i),this.currentPointers[t]=i)}0!==o.length&&this._moveCallback(e,o,t)}_triggerPointerEnd(t,e){const n=this.currentPointers.findIndex(e=>e.id===t.id);return-1!==n&&(this.currentPointers.splice(n,1),this.startPointers.splice(n,1),this._endCallback(t,e),!0)}_pointerEnd(t){if(this._triggerPointerEnd(new u(t),t))if(p(t)){if(this.currentPointers.length)return;this._element.removeEventListener("pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd)}else window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)}_touchEnd(t){for(const e of Array.from(t.changedTouches))this._triggerPointerEnd(new u(e),t)}};n(34);function g(t,e){return e?Math.sqrt((e.clientX-t.clientX)**2+(e.clientY-t.clientY)**2):0}function f(t,e){return e?{clientX:(t.clientX+e.clientX)/2,clientY:(t.clientY+e.clientY)/2}:t}function m(t,e){return"number"==typeof t?t:t.trimRight().endsWith("%")?e*parseFloat(t)/100:parseFloat(t)}let v;function O(){return v||(v=document.createElementNS("http://www.w3.org/2000/svg","svg"))}function y(){return O().createSVGMatrix()}function _(){return O().createSVGPoint()}const j=.01;customElements.define("pinch-zoom",class extends HTMLElement{constructor(){super(),this._transform=y(),new MutationObserver(()=>this._stageElChange()).observe(this,{childList:!0});const t=new b(this,{start:(e,n)=>!(2===t.currentPointers.length||!this._positioningEl||(n.preventDefault(),0)),move:e=>{this._onPointerMove(e,t.currentPointers)}});this.addEventListener("wheel",t=>this._onWheel(t))}connectedCallback(){this._stageElChange()}get x(){return this._transform.e}get y(){return this._transform.f}get scale(){return this._transform.a}scaleTo(t,e={}){let{originX:n=0,originY:o=0}=e;const{relativeTo:i="content",allowChangeEvent:s=!1}=e,r="content"===i?this._positioningEl:this;if(!r||!this._positioningEl)return void this.setTransform({scale:t,allowChangeEvent:s});const a=r.getBoundingClientRect();if(n=m(n,a.width),o=m(o,a.height),"content"===i)n+=this.x,o+=this.y;else{const t=this._positioningEl.getBoundingClientRect();n-=t.left,o-=t.top}this._applyChange({allowChangeEvent:s,originX:n,originY:o,scaleDiff:t/this.scale})}setTransform(t={}){const{scale:e=this.scale,allowChangeEvent:n=!1}=t;let{x:o=this.x,y:i=this.y}=t;if(!this._positioningEl)return void this._updateTransform(e,o,i,n);const s=this.getBoundingClientRect(),r=this._positioningEl.getBoundingClientRect();if(!s.width||!s.height)return void this._updateTransform(e,o,i,n);let a=_();a.x=r.left-s.left,a.y=r.top-s.top;let c=_();c.x=r.width+a.x,c.y=r.height+a.y;const l=y().translate(o,i).scale(e).multiply(this._transform.inverse());a=a.matrixTransform(l),c=c.matrixTransform(l),a.x>s.width?o+=s.width-a.x:c.x<0&&(o+=-c.x),a.y>s.height?i+=s.height-a.y:c.y<0&&(i+=-c.y),this._updateTransform(e,o,i,n)}_updateTransform(t,e,n,o){if(!(t<j)&&(t!==this.scale||e!==this.x||n!==this.y)&&(this._transform.e=e,this._transform.f=n,this._transform.d=this._transform.a=t,this.style.setProperty("--x",this.x+"px"),this.style.setProperty("--y",this.y+"px"),this.style.setProperty("--scale",this.scale+""),o)){const t=new Event("change",{bubbles:!0});this.dispatchEvent(t)}}_stageElChange(){this._positioningEl=void 0,0!==this.children.length&&(this._positioningEl=this.children[0],this.children.length>1&&console.warn("<pinch-zoom> must not have more than one child."),this.setTransform({allowChangeEvent:!0}))}_onWheel(t){if(!this._positioningEl)return;t.preventDefault();const e=this._positioningEl.getBoundingClientRect();let{deltaY:n}=t;const{ctrlKey:o,deltaMode:i}=t;1===i&&(n*=15);const s=1-n/(o?100:300);this._applyChange({scaleDiff:s,originX:t.clientX-e.left,originY:t.clientY-e.top,allowChangeEvent:!0})}_onPointerMove(t,e){if(!this._positioningEl)return;const n=this._positioningEl.getBoundingClientRect(),o=f(t[0],t[1]),i=f(e[0],e[1]),s=o.clientX-n.left,r=o.clientY-n.top,a=g(t[0],t[1]),c=g(e[0],e[1]),l=a?c/a:1;this._applyChange({originX:s,originY:r,scaleDiff:l,panX:i.clientX-o.clientX,panY:i.clientY-o.clientY,allowChangeEvent:!0})}_applyChange(t={}){const{panX:e=0,panY:n=0,originX:o=0,originY:i=0,scaleDiff:s=1,allowChangeEvent:r=!1}=t,a=y().translate(e,n).translate(o,i).translate(this.x,this.y).scale(s).translate(-o,-i).scale(this.scale);this.setTransform({allowChangeEvent:r,scale:a.a,x:a.e,y:a.f})}});var w=n(30);const C="legacy-clip-compat",E="orientation";customElements.define("two-up",class extends HTMLElement{constructor(){super(),this._handle=document.createElement("div"),this._position=0,this._relativePosition=.5,this._positionOnPointerStart=0,this._everConnected=!1,this._handle.className=w.twoUpHandle,new MutationObserver(()=>this._childrenChange()).observe(this,{childList:!0}),"ResizeObserver"in window?new ResizeObserver(()=>this._resetPosition()).observe(this):window.addEventListener("resize",()=>this._resetPosition());const t=new b(this._handle,{start:(e,n)=>1!==t.currentPointers.length&&(n.preventDefault(),this._positionOnPointerStart=this._position,!0),move:()=>{this._pointerChange(t.startPointers[0],t.currentPointers[0])}})}static get observedAttributes(){return[E]}connectedCallback(){this._childrenChange(),this._handle.innerHTML=`<div class="${w.scrubber}"><svg viewBox="0 0 27 20" fill="currentColor"><path d="M17 19.2l9.5-9.6L16.9 0zM9.6 0L0 9.6l9.6 9.6z"/></svg></div>`,this._everConnected||(this._resetPosition(),this._everConnected=!0)}attributeChangedCallback(t){t===E&&this._resetPosition()}_resetPosition(){requestAnimationFrame(()=>{const t=this.getBoundingClientRect(),e="vertical"===this.orientation?"height":"width";this._position=t[e]*this._relativePosition,this._setPosition()})}get legacyClipCompat(){return this.hasAttribute(C)}set legacyClipCompat(t){t?this.setAttribute(C,""):this.removeAttribute(C)}get orientation(){const t=this.getAttribute(E);return t&&"vertical"===t.toLowerCase()?"vertical":"horizontal"}set orientation(t){this.setAttribute(E,t)}_childrenChange(){this.lastElementChild!==this._handle&&this.appendChild(this._handle)}_pointerChange(t,e){const n="vertical"===this.orientation?"clientY":"clientX",o="vertical"===this.orientation?"height":"width",i=this.getBoundingClientRect();this._position=this._positionOnPointerStart+(e[n]-t[n]),this._position=Math.max(0,Math.min(this._position,i[o])),this._relativePosition=this._position/i[o],this._setPosition()}_setPosition(){this.style.setProperty("--split-point",`${this._position}px`)}});var x=n(35),P=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]])}return n};const S=t=>Object(a.b)("svg",Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},t)),k=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-7h-2zm-6 .7l2.6-2.6 1.4 1.4-5 5-5-5 1.4-1.4 2.6 2.6V3h2z"})),z=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm2 4v-2H3c0 1.1.9 2 2 2zM3 9h2V7H3v2zm12 12h2v-2h-2v2zm4-18H9a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm0 12H9V5h10v10zm-8 6h2v-2h-2v2zm-4 0h2v-2H7v2z"})),T=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M9 7H7v2h2V7zm0 4H7v2h2v-2zm0-8a2 2 0 0 0-2 2h2V3zm4 12h-2v2h2v-2zm6-12v2h2a2 2 0 0 0-2-2zm-6 0h-2v2h2V3zM9 17v-2H7c0 1.1.9 2 2 2zm10-4h2v-2h-2v2zm0-4h2V7h-2v2zm0 8a2 2 0 0 0 2-2h-2v2zM5 7H3v12c0 1.1.9 2 2 2h12v-2H5V7zm10-2h2V3h-2v2zm0 12h2v-2h-2v2z"})),A=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M15.6 5.5L11 1v3a8 8 0 0 0 0 16v-2a6 6 0 0 1 0-12v4l4.5-4.5zm4.3 5.5a8 8 0 0 0-1.6-3.9L17 8.5c.5.8.9 1.6 1 2.5h2zM13 17.9v2a8 8 0 0 0 3.9-1.6L15.5 17c-.8.5-1.6.9-2.5 1zm3.9-2.4l1.4 1.4A8 8 0 0 0 20 13h-2c-.1.9-.5 1.7-1 2.5z"})),I=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})),R=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M19 13H5v-2h14v2z"})),L=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M21.3 2.7v18.6H2.7V2.7h18.6m0-2.7H2.7A2.7 2.7 0 0 0 0 2.7v18.6A2.7 2.7 0 0 0 2.7 24h18.6a2.7 2.7 0 0 0 2.7-2.7V2.7A2.7 2.7 0 0 0 21.3 0z"})),M=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M21.3 0H2.7A2.7 2.7 0 0 0 0 2.7v18.6A2.7 2.7 0 0 0 2.7 24h18.6a2.7 2.7 0 0 0 2.7-2.7V2.7A2.7 2.7 0 0 0 21.3 0zm-12 18.7L2.7 12l1.8-1.9L9.3 15 19.5 4.8l1.8 1.9z"})),B=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M16.6 8.6L12 13.2 7.4 8.6 6 10l6 6 6-6z"})),D=t=>Object(a.b)(S,Object.assign({},t),Object(a.b)("path",{d:"M20 11H7.8l5.6-5.6L12 4l-8 8 8 8 1.4-1.4L7.8 13H20v-2z"})),H={up:90,right:180,down:-90,left:0},q=t=>{const{copyDirection:e}=t,n=P(t,["copyDirection"]),o="point-"+e,i=H[e];return Object(a.b)(S,Object.assign({},n),Object(a.b)("defs",null,Object(a.b)("clipPath",{id:o},Object(a.b)("path",{d:"M-12-12v24h24v-24zM4.5 2h-4v3l-5-5 5-5v3h4z",transform:`translate(12 13) rotate(${i})`}))),Object(a.b)("path",{"clip-path":`url(#${o})`,d:"M19 3h-4.2c-.4-1.2-1.5-2-2.8-2s-2.4.8-2.8 2H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm-7 0a1 1 0 0 1 0 2c-.6 0-1-.4-1-1s.4-1 1-1z"}))};function F(t,e,n,o){const i=Array.isArray(e)?e:(""+e).split(".");let s=W(t);const r=s,a=i.length-1;for(const[c,l]of i.entries())c!==a?s=s[l]=W(s[l]):s[l]=o?Object.assign(W(s[l]),n):n;return r}function W(t){return Array.isArray(t)?[...t]:Object.assign({},t)}function U(t,e,n){return F(t,e,n,!0)}function $(t,e,n){return F(t,e,n,!1)}var N=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};const V={originX:"50%",originY:"50%",relativeTo:"container",allowChangeEvent:!0};class Y extends a.a{constructor(){super(...arguments),this.state={scale:1,editingScale:!1,altBackground:!1},this.retargetedEvents=new WeakSet}componentDidMount(){const t=this.leftDrawable(),e=this.rightDrawable();this.pinchZoomLeft.setTransform({allowChangeEvent:!0,x:0,y:0,scale:1}),this.canvasLeft&&t&&Object(l.f)(this.canvasLeft,t),this.canvasRight&&e&&Object(l.f)(this.canvasRight,e)}componentDidUpdate(t,e){const n=this.leftDrawable(t),o=this.rightDrawable(t),i=this.leftDrawable(),s=this.rightDrawable(),r=!!this.props.source!=!!t.source||this.props.source&&t.source&&this.props.source.file!==t.source.file,a=t.source&&t.source.processed,c=this.props.source&&this.props.source.processed,h=this.pinchZoomLeft;if(r)h.setTransform({allowChangeEvent:!0,x:0,y:0,scale:1});else if(a&&c&&a!==c){const t=1-h.scale,e=a.width/2*t,n=a.height/2*t;h.setTransform({allowChangeEvent:!0,x:h.x-e+n,y:h.y-n+e})}i&&i!==n&&this.canvasLeft&&Object(l.f)(this.canvasLeft,i),s&&s!==o&&this.canvasRight&&Object(l.f)(this.canvasRight,s)}shouldComponentUpdate(t,e){return!Object(l.p)(this.props,t)||!Object(l.p)(this.state,e)}leftDrawable(t=this.props){return t.leftCompressed||t.source&&t.source.processed}rightDrawable(t=this.props){return t.rightCompressed||t.source&&t.source.processed}toggleBackground(){this.setState({altBackground:!this.state.altBackground})}zoomIn(){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(1.25*this.state.scale,V)}zoomOut(){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(this.state.scale/1.25,V)}onRotateClick(){const{inputProcessorState:t}=this.props;if(!t)return;const e=$(t,"rotate.rotate",(t.rotate.rotate+90)%360);this.props.onInputProcessorChange(e)}onScaleValueFocus(){this.setState({editingScale:!0},()=>{this.scaleInput&&(getComputedStyle(this.scaleInput).transform,this.scaleInput.focus())})}onScaleInputBlur(){this.setState({editingScale:!1})}onScaleInputChanged(t){const e=t.target,n=parseFloat(e.value);if(!isNaN(n)){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(n/100,V)}}onPinchZoomLeftChange(t){if(!this.pinchZoomRight||!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.setState({scale:this.pinchZoomLeft.scale}),this.pinchZoomRight.setTransform({scale:this.pinchZoomLeft.scale,x:this.pinchZoomLeft.x,y:this.pinchZoomLeft.y})}onRetargetableEvent(t){const e=t.target;if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");if("wheel"!==t.type&&e.closest(`.${w.twoUpHandle}`))return;if(this.retargetedEvents.has(t))return;t.stopImmediatePropagation(),t.preventDefault();const n=new t.constructor(t.type,t);this.retargetedEvents.add(n),this.pinchZoomLeft.dispatchEvent(n),"touchend"===t.type&&document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}render({mobileView:t,leftImgContain:e,rightImgContain:n,source:o,onBack:i},{scale:s,editingScale:r,altBackground:l}){const h=this.leftDrawable(),u=this.rightDrawable(),p=o&&o.processed;return Object(a.b)("div",{class:`${x.output} ${l?x.altBackground:""}`},Object(a.b)("two-up",{"legacy-clip-compat":!0,class:x.twoUp,orientation:t?"vertical":"horizontal",onTouchStartCapture:this.onRetargetableEvent,onTouchEndCapture:this.onRetargetableEvent,onTouchMoveCapture:this.onRetargetableEvent,onPointerDownCapture:this.onRetargetableEvent,onMouseDownCapture:this.onRetargetableEvent,onWheelCapture:this.onRetargetableEvent},Object(a.b)("pinch-zoom",{class:x.pinchZoom,onChange:this.onPinchZoomLeftChange,ref:Object(c.c)(this,"pinchZoomLeft")},Object(a.b)("canvas",{class:x.pinchTarget,ref:Object(c.c)(this,"canvasLeft"),width:h&&h.width,height:h&&h.height,style:{width:p&&p.width,height:p&&p.height,objectFit:e?"contain":""}})),Object(a.b)("pinch-zoom",{class:x.pinchZoom,ref:Object(c.c)(this,"pinchZoomRight")},Object(a.b)("canvas",{class:x.pinchTarget,ref:Object(c.c)(this,"canvasRight"),width:u&&u.width,height:u&&u.height,style:{width:p&&p.width,height:p&&p.height,objectFit:n?"contain":""}}))),Object(a.b)("div",{class:x.back},Object(a.b)("button",{class:x.button,onClick:i},Object(a.b)(D,null))),Object(a.b)("div",{class:x.controls},Object(a.b)("div",{class:x.zoomControls},Object(a.b)("button",{class:x.button,onClick:this.zoomOut},Object(a.b)(R,null)),r?Object(a.b)("input",{type:"number",step:"1",min:"1",max:"1000000",ref:Object(c.c)(this,"scaleInput"),class:x.zoom,value:Math.round(100*s),onInput:this.onScaleInputChanged,onBlur:this.onScaleInputBlur}):Object(a.b)("span",{class:x.zoom,tabIndex:0,onFocus:this.onScaleValueFocus},Object(a.b)("span",{class:x.zoomValue},Math.round(100*s)),"%"),Object(a.b)("button",{class:x.button,onClick:this.zoomIn},Object(a.b)(I,null))),Object(a.b)("div",{class:x.buttonsNoWrap},Object(a.b)("button",{class:x.button,onClick:this.onRotateClick,title:"Rotate image"},Object(a.b)(A,null)),Object(a.b)("button",{class:`${x.button} ${l?x.active:""}`,onClick:this.toggleBackground,title:"Change canvas color"},l?Object(a.b)(T,null):Object(a.b)(z,null)))))}}N([c.b],Y.prototype,"toggleBackground",null),N([c.b],Y.prototype,"zoomIn",null),N([c.b],Y.prototype,"zoomOut",null),N([c.b],Y.prototype,"onRotateClick",null),N([c.b],Y.prototype,"onScaleValueFocus",null),N([c.b],Y.prototype,"onScaleInputBlur",null),N([c.b],Y.prototype,"onScaleInputChanged",null),N([c.b],Y.prototype,"onPinchZoomLeftChange",null),N([c.b],Y.prototype,"onRetargetableEvent",null);var G=n(20),J=n(36),Z=n(37),X=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};const Q=["focus","blur"],K=["input","change"],tt=["name","min","max","step","value","disabled"],et=["name","min","max","step","value","disabled"];class nt extends HTMLElement{constructor(){super(),this._ignoreChange=!1,this._input=document.createElement("input"),this._input.type="range",this._input.className=Z.input;const t=new b(this._input,{start:()=>0===t.currentPointers.length&&(this._input.classList.add(Z.touchActive),!0),end:()=>{this._input.classList.remove(Z.touchActive)}});for(const e of Q)this._input.addEventListener(e,this._retargetEvent,!0);for(const e of K)this._input.addEventListener(e,this._update,!0)}static get observedAttributes(){return et}connectedCallback(){this.contains(this._input)||(this.innerHTML=`<div class="${Z.thumbWrapper}">`+`<div class="${Z.thumb}"></div>`+`<div class="${Z.valueDisplay}"></div>`+"</div>",this.insertBefore(this._input,this.firstChild),this._valueDisplay=this.querySelector("."+Z.valueDisplay),this._update())}get labelPrecision(){return this.getAttribute("label-precision")||""}set labelPrecision(t){this.setAttribute("label-precision",t)}attributeChangedCallback(t,e,n){this._ignoreChange||(null===n?this._input.removeAttribute(t):this._input.setAttribute(t,n),this._reflectAttributes(),this._update())}_retargetEvent(t){t.stopImmediatePropagation();const e=new Event(t.type,t);this.dispatchEvent(e)}_update(){const t=Number(this.value)||0,e=Number(this.min)||0,n=Number(this.max)||100,o=Number(this.labelPrecision)||function(t){const e=t.split(".")[1];return e?e.length:0}(this.step)||0,i=100*(t-e)/(n-e),s=o?t.toFixed(o):Math.round(t).toString();this._valueDisplay.textContent=s,this.style.setProperty("--value-percent",i+"%"),this.style.setProperty("--value-width",""+s.length)}_reflectAttributes(){this._ignoreChange=!0;for(const t of et)this._input.hasAttribute(t)?this.setAttribute(t,this._input.getAttribute(t)):this.removeAttribute(t);this._ignoreChange=!1}}X([c.b],nt.prototype,"_retargetEvent",null),X([c.b],nt.prototype,"_update",null);for(const We of tt)Object.defineProperty(nt.prototype,We,{get(){return this._input[We]},set(t){this._input[We]=t,this._reflectAttributes(),this._update()}});customElements.define("range-input",nt);var ot,it=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]])}return n};class st extends a.a{onTextInput(t){const e=t.target;if(!e.value.trim())return;this.rangeWc.value=e.value;const{onInput:n}=this.props;n&&n(t)}render(t){const{children:e}=t,n=it(t,["children"]),{value:o,min:i,max:s,step:r}=t;return Object(a.b)("label",{class:J.range},Object(a.b)("span",{class:J.labelText},e),Object(a.b)("div",{class:J.rangeWcContainer},Object(a.b)("range-input",Object.assign({ref:Object(c.c)(this,"rangeWc"),class:J.rangeWc},n))),Object(a.b)("input",{type:"number",class:J.textInput,value:o,min:i,max:s,step:r,onInput:this.onTextInput}))}}(function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);s>3&&r&&Object.defineProperty(e,n,r)})([c.b],st.prototype,"onTextInput",null);class rt extends a.a{onChange(t){const e=t.currentTarget.closest("form"),n={level:Object(l.k)(e.level)};this.props.onChange(n)}render({options:t}){return Object(a.b)("form",{class:G.optionsSection,onSubmit:l.o},Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"level",min:"0",max:"7",step:"1",value:t.level,onInput:this.onChange},"Effort:")))}}(function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);s>3&&r&&Object.defineProperty(e,n,r)})([c.b],rt.prototype,"onChange",null),function(t){t[t.GRAYSCALE=1]="GRAYSCALE",t[t.RGB=2]="RGB",t[t.YCbCr=3]="YCbCr"}(ot||(ot={}));const at="mozjpeg",ct="MozJPEG",lt="image/jpeg",ht="jpg",ut={quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:ot.YCbCr,quant_table:3,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75};var pt=n(38);class dt extends a.a{render(t){return Object(a.b)("div",{class:pt.checkbox},t.checked?Object(a.b)(M,{class:`${pt.icon} ${pt.checked}`}):Object(a.b)(L,{class:pt.icon}),Object(a.b)("input",Object.assign({class:pt.realCheckbox,type:"checkbox"},t)))}}var bt=n(39);class gt extends a.a{constructor(){super(...arguments),this.state={outgoingChildren:[]},this.lastElHeight=0}componentWillReceiveProps(t){const e=this.props.children;!t.children[0]&&e[0]&&this.setState({outgoingChildren:e})}componentWillUpdate(t){const e=this.props.children,n=t.children;e[0]&&n[0]||!e[0]&&!n[0]||(this.lastElHeight=this.base.getBoundingClientRect().height)}async componentDidUpdate(t){const e=this.props.children,n=t.children;if(e[0]&&n[0]||!e[0]&&!n[0])return;this.base.style.height="",this.base.style.overflow="hidden";const o=e[0]?this.base.getBoundingClientRect().height:0;await Object(l.r)(this.base,{duration:300,from:this.lastElHeight,to:o}),this.base.style.height="",this.base.style.overflow="",this.state.outgoingChildren[0]&&this.setState({outgoingChildren:[]})}render(t,{outgoingChildren:e}){const n=t.children,o=!n[0]&&e[0];return Object(a.b)("div",{class:o?bt.childrenExiting:""},n[0]?n:e)}}var ft=n(40),mt=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]])}return n};class vt extends a.a{render(t){const{large:e}=t,n=mt(t,["large"]);return Object(a.b)("div",{class:ft.select},Object(a.b)("select",Object.assign({class:`${ft.nativeSelect} ${e?ft.large:""}`},n)),Object(a.b)("svg",{class:ft.arrow,viewBox:"0 0 10 5"},Object(a.b)("path",{d:"M0 0l5 5 5-5z"})))}}var Ot=function(t,e,n){var o=e.split("."),i=t.__lsc||(t.__lsc={});return i[e+n]||(i[e+n]=function(e){for(var i=e&&e.target||this,s={},r=s,a="string"==typeof n?function(t,e,n,o){for(o=0,e=e.split?e.split("."):e;t&&o<e.length;)t=t[e[o++]];return void 0===t?n:t}(e,n):i.nodeName?i.type.match(/^che|rad/)?i.checked:i.value:e,c=0;c<o.length-1;c++)r=r[o[c]]||(r[o[c]]=!c&&t.state[o[c]]||{});r[o[c]]=a,t.setState(s)})};class yt extends a.a{constructor(){super(...arguments),this.state={showAdvanced:!1}}onChange(t){const e=t.currentTarget.closest("form"),{options:n}=this.props,o=Object.assign({},this.props.options,{baseline:Object(l.h)(e.baseline,n.baseline),progressive:Object(l.h)(e.progressive,n.progressive),optimize_coding:Object(l.h)(e.optimize_coding,n.optimize_coding),trellis_multipass:Object(l.h)(e.trellis_multipass,n.trellis_multipass),trellis_opt_zero:Object(l.h)(e.trellis_opt_zero,n.trellis_opt_zero),trellis_opt_table:Object(l.h)(e.trellis_opt_table,n.trellis_opt_table),auto_subsample:Object(l.h)(e.auto_subsample,n.auto_subsample),separate_chroma_quality:Object(l.h)(e.separate_chroma_quality,n.separate_chroma_quality),quality:Object(l.k)(e.quality,n.quality),chroma_quality:Object(l.k)(e.chroma_quality,n.chroma_quality),chroma_subsample:Object(l.k)(e.chroma_subsample,n.chroma_subsample),smoothing:Object(l.k)(e.smoothing,n.smoothing),color_space:Object(l.k)(e.color_space,n.color_space),quant_table:Object(l.k)(e.quant_table,n.quant_table),trellis_loops:Object(l.k)(e.trellis_loops,n.trellis_loops)});this.props.onChange(o)}render({options:t},{showAdvanced:e}){return Object(a.b)("form",{class:G.optionsSection,onSubmit:l.o},Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"quality",min:"0",max:"100",value:t.quality,onInput:this.onChange},"Quality:")),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{checked:e,onChange:Ot(this,"showAdvanced")}),"Show advanced settings"),Object(a.b)(gt,null,e?Object(a.b)("div",null,Object(a.b)("label",{class:G.optionTextFirst},"Channels:",Object(a.b)(vt,{name:"color_space",value:t.color_space,onChange:this.onChange},Object(a.b)("option",{value:ot.GRAYSCALE},"Grayscale"),Object(a.b)("option",{value:ot.RGB},"RGB"),Object(a.b)("option",{value:ot.YCbCr},"YCbCr"))),Object(a.b)(gt,null,t.color_space===ot.YCbCr?Object(a.b)("div",null,Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"auto_subsample",checked:t.auto_subsample,onChange:this.onChange}),"Auto subsample chroma"),Object(a.b)(gt,null,t.auto_subsample?null:Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"chroma_subsample",min:"1",max:"4",value:t.chroma_subsample,onInput:this.onChange},"Subsample chroma by:"))),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"separate_chroma_quality",checked:t.separate_chroma_quality,onChange:this.onChange}),"Separate chroma quality"),Object(a.b)(gt,null,t.separate_chroma_quality?Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"chroma_quality",min:"0",max:"100",value:t.chroma_quality,onInput:this.onChange},"Chroma quality:")):null)):null),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"baseline",checked:t.baseline,onChange:this.onChange}),"Pointless spec compliance"),Object(a.b)(gt,null,t.baseline?null:Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"progressive",checked:t.progressive,onChange:this.onChange}),"Progressive rendering")),Object(a.b)(gt,null,t.baseline?Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"optimize_coding",checked:t.optimize_coding,onChange:this.onChange}),"Optimize Huffman table"):null),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"smoothing",min:"0",max:"100",value:t.smoothing,onInput:this.onChange},"Smoothing:")),Object(a.b)("label",{class:G.optionTextFirst},"Quantization:",Object(a.b)(vt,{name:"quant_table",value:t.quant_table,onChange:this.onChange},Object(a.b)("option",{value:"0"},"JPEG Annex K"),Object(a.b)("option",{value:"1"},"Flat"),Object(a.b)("option",{value:"2"},"MSSIM-tuned Kodak"),Object(a.b)("option",{value:"3"},"ImageMagick"),Object(a.b)("option",{value:"4"},"PSNR-HVS-M-tuned Kodak"),Object(a.b)("option",{value:"5"},"Klein et al"),Object(a.b)("option",{value:"6"},"Watson et al"),Object(a.b)("option",{value:"7"},"Ahumada et al"),Object(a.b)("option",{value:"8"},"Peterson et al"))),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"trellis_multipass",checked:t.trellis_multipass,onChange:this.onChange}),"Trellis multipass"),Object(a.b)(gt,null,t.trellis_multipass?Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"trellis_opt_zero",checked:t.trellis_opt_zero,onChange:this.onChange}),"Optimize zero block runs"):null),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"trellis_opt_table",checked:t.trellis_opt_table,onChange:this.onChange}),"Optimize after trellis quantization"),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"trellis_loops",min:"1",max:"50",value:t.trellis_loops,onInput:this.onChange},"Trellis quantization passes:"))):null))}}(function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);s>3&&r&&Object.defineProperty(e,n,r)})([c.b],yt.prototype,"onChange",null);var _t=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};function jt(t={}){const{min:e=0,max:n=100,step:o=1}=t;class i extends a.a{onChange(t){const e=t.currentTarget;this.props.onChange({quality:Number(e.value)})}render({options:t}){return Object(a.b)("div",{class:G.optionsSection},Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"quality",min:e,max:n,step:o||"any",value:t.quality,onInput:this.onChange},"Quality:")))}}return _t([c.b],i.prototype,"onChange",null),i}var wt,Ct=jt({min:0,max:1,step:.01});!function(t){t[t.WEBP_HINT_DEFAULT=0]="WEBP_HINT_DEFAULT",t[t.WEBP_HINT_PICTURE=1]="WEBP_HINT_PICTURE",t[t.WEBP_HINT_PHOTO=2]="WEBP_HINT_PHOTO",t[t.WEBP_HINT_GRAPH=3]="WEBP_HINT_GRAPH"}(wt||(wt={}));const Et="webp",xt="WebP",Pt="image/webp",St="webp",kt={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0};const zt=[[0,0],[1,20],[2,25],[3,30],[3,50],[4,50],[4,75],[4,90],[5,90],[6,100]],Tt=6;function At(t,e){const n=zt.findIndex(([n,o])=>n===e&&o===t);return-1!==n?n:Tt}class It extends a.a{constructor(){super(...arguments),this.state={showAdvanced:!1}}onChange(t){const e=t.currentTarget.closest("form"),n=Object(l.i)(e.lossless),{options:o}=this.props,i=Object(l.k)(e.lossless_preset,At(o.quality,o.method)),s=Object.assign({},o,{lossless:n,quality:n?zt[i][1]:Object(l.k)(e.quality,o.quality),method:n?zt[i][0]:Object(l.k)(e.method_input,o.method),image_hint:Object(l.i)(e.image_hint,o.image_hint)?wt.WEBP_HINT_GRAPH:wt.WEBP_HINT_DEFAULT,exact:Object(l.i)(e.exact,o.exact),alpha_compression:Object(l.i)(e.alpha_compression,o.alpha_compression),autofilter:Object(l.i)(e.autofilter,o.autofilter),filter_type:Object(l.i)(e.filter_type,o.filter_type),use_sharp_yuv:Object(l.i)(e.use_sharp_yuv,o.use_sharp_yuv),near_lossless:100-Object(l.k)(e.near_lossless,100-o.near_lossless),alpha_quality:Object(l.k)(e.alpha_quality,o.alpha_quality),alpha_filtering:Object(l.k)(e.alpha_filtering,o.alpha_filtering),sns_strength:Object(l.k)(e.sns_strength,o.sns_strength),filter_strength:Object(l.k)(e.filter_strength,o.filter_strength),filter_sharpness:7-Object(l.k)(e.filter_sharpness,7-o.filter_sharpness),pass:Object(l.k)(e.pass,o.pass),preprocessing:Object(l.k)(e.preprocessing,o.preprocessing),segments:Object(l.k)(e.segments,o.segments),partitions:Object(l.k)(e.partitions,o.partitions)});this.props.onChange(s)}_losslessSpecificOptions(t){return Object(a.b)("div",{key:"lossless"},Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"lossless_preset",min:"0",max:"9",value:At(t.quality,t.method),onInput:this.onChange},"Effort:")),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"near_lossless",min:"0",max:"100",value:""+(100-t.near_lossless),onInput:this.onChange},"Slight loss:")),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"image_hint",checked:t.image_hint===wt.WEBP_HINT_GRAPH,onChange:this.onChange}),"Discrete tone image"))}_lossySpecificOptions(t){const{showAdvanced:e}=this.state;return Object(a.b)("div",{key:"lossy"},Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"method_input",min:"0",max:"6",value:t.method,onInput:this.onChange},"Effort:")),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"quality",min:"0",max:"100",step:"0.1",value:t.quality,onInput:this.onChange},"Quality:")),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{checked:e,onChange:Ot(this,"showAdvanced")}),"Show advanced settings"),Object(a.b)(gt,null,e?Object(a.b)("div",null,Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"alpha_compression",checked:!!t.alpha_compression,onChange:this.onChange}),"Compress alpha"),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"alpha_quality",min:"0",max:"100",value:t.alpha_quality,onInput:this.onChange},"Alpha quality:")),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"alpha_filtering",min:"0",max:"2",value:t.alpha_filtering,onInput:this.onChange},"Alpha filter quality:")),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"autofilter",checked:!!t.autofilter,onChange:this.onChange}),"Auto adjust filter strength"),Object(a.b)(gt,null,t.autofilter?null:Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"filter_strength",min:"0",max:"100",value:t.filter_strength,onInput:this.onChange},"Filter strength:"))),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"filter_type",checked:!!t.filter_type,onChange:this.onChange}),"Strong filter"),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"filter_sharpness",min:"0",max:"7",value:7-t.filter_sharpness,onInput:this.onChange},"Filter sharpness:")),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"use_sharp_yuv",checked:!!t.use_sharp_yuv,onChange:this.onChange}),"Sharp RGB→YUV conversion"),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"pass",min:"1",max:"10",value:t.pass,onInput:this.onChange},"Passes:")),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"sns_strength",min:"0",max:"100",value:t.sns_strength,onInput:this.onChange},"Spacial noise shaping:")),Object(a.b)("label",{class:G.optionTextFirst},"Preprocess:",Object(a.b)(vt,{name:"preprocessing",value:t.preprocessing,onChange:this.onChange},Object(a.b)("option",{value:"0"},"None"),Object(a.b)("option",{value:"1"},"Segment smooth"),Object(a.b)("option",{value:"2"},"Pseudo-random dithering"))),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"segments",min:"1",max:"4",value:t.segments,onInput:this.onChange},"Segments:")),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"partitions",min:"0",max:"3",value:t.partitions,onInput:this.onChange},"Partitions:"))):null))}render({options:t}){return Object(a.b)("form",{class:G.optionsSection,onSubmit:l.o},Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"lossless",checked:!!t.lossless,onChange:this.onChange}),"Lossless"),t.lossless?this._losslessSpecificOptions(t):this._lossySpecificOptions(t),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"exact",checked:!!t.exact,onChange:this.onChange}),"Preserve transparent data"))}}(function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);s>3&&r&&Object.defineProperty(e,n,r)})([c.b],It.prototype,"onChange",null);var Rt=jt({min:0,max:1,step:.01}),Lt=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};const Mt=Object(l.l)();class Bt extends a.a{constructor(){super(...arguments),this.state={extendedSettings:!1}}componentDidMount(){Mt.then(()=>{this.setState({extendedSettings:!0})})}onChange(t){const e=t.currentTarget.closest("form"),{options:n}=this.props,o={zx:Object(l.k)(e.zx,n.zx),maxNumColors:Object(l.k)(e.maxNumColors,n.maxNumColors),dither:Object(l.k)(e.dither)};this.props.onChange(o)}render({options:t},{extendedSettings:e}){return Object(a.b)("form",{class:G.optionsSection,onSubmit:l.o},Object(a.b)(gt,null,e?Object(a.b)("label",{class:G.optionTextFirst},"Type:",Object(a.b)(vt,{name:"zx",value:""+t.zx,onChange:this.onChange},Object(a.b)("option",{value:"0"},"Standard"),Object(a.b)("option",{value:"1"},"ZX"))):null),Object(a.b)(gt,null,t.zx?null:Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"maxNumColors",min:"2",max:"256",value:t.maxNumColors,onInput:this.onChange},"Colors:"))),Object(a.b)("div",{class:G.optionOneCell},Object(a.b)(st,{name:"dither",min:"0",max:"1",step:"0.01",value:t.dither,onInput:this.onChange},"Dithering:")))}}Lt([c.b],Bt.prototype,"onChange",null);const Dt=["triangle","catrom","mitchell","lanczos3","hqx"];function Ht(t){return Dt.includes(t.method)}var qt=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};const Ft=[.25,.3333,.5,1,2,3,4];class Wt extends a.a{constructor(t){super(t),this.state={maintainAspect:!0},this.presetWidths={},this.presetHeights={},this.generatePresetValues(t.inputWidth,t.inputHeight)}reportOptions(){const t=this.form,e=t.width,n=t.height,{options:o}=this.props;if(!e.checkValidity()||!n.checkValidity())return;const i={width:Object(l.k)(e),height:Object(l.k)(n),method:t.resizeMethod.value,premultiply:Object(l.h)(t.premultiply,!0),linearRGB:Object(l.h)(t.linearRGB,!0),fitMethod:Object(l.j)(t.fitMethod,o.fitMethod)};this.props.onChange(i)}onChange(){this.reportOptions()}getAspect(){return this.props.inputWidth/this.props.inputHeight}componentDidUpdate(t,e){!e.maintainAspect&&this.state.maintainAspect&&(this.form.height.value=Math.round(Number(this.form.width.value)/this.getAspect()),this.reportOptions())}componentWillReceiveProps(t){this.props.inputWidth===t.inputWidth&&this.props.inputHeight===t.inputHeight||this.generatePresetValues(t.inputWidth,t.inputHeight)}onWidthInput(){if(this.state.maintainAspect){const t=Object(l.k)(this.form.width);this.form.height.value=Math.round(t/this.getAspect())}this.reportOptions()}onHeightInput(){if(this.state.maintainAspect){const t=Object(l.k)(this.form.height);this.form.width.value=Math.round(t*this.getAspect())}this.reportOptions()}generatePresetValues(t,e){for(const n of Ft)this.presetWidths[n]=Math.round(t*n),this.presetHeights[n]=Math.round(e*n)}getPreset(){const{width:t,height:e}=this.props.options;for(const n of Ft)if(t===this.presetWidths[n]&&e===this.presetHeights[n])return n;return"custom"}onPresetChange(t){const e=t.target;if("custom"===e.value)return;const n=Number(e.value);this.form.width.value=Math.round(this.props.inputWidth*n)+"",this.form.height.value=Math.round(this.props.inputHeight*n)+"",this.reportOptions()}render({options:t,isVector:e},{maintainAspect:n}){return Object(a.b)("form",{ref:Object(c.c)(this,"form"),class:G.optionsSection,onSubmit:l.o},Object(a.b)("label",{class:G.optionTextFirst},"Method:",Object(a.b)(vt,{name:"resizeMethod",value:t.method,onChange:this.onChange},e&&Object(a.b)("option",{value:"vector"},"Vector"),Object(a.b)("option",{value:"lanczos3"},"Lanczos3"),Object(a.b)("option",{value:"mitchell"},"Mitchell"),Object(a.b)("option",{value:"catrom"},"Catmull-Rom"),Object(a.b)("option",{value:"triangle"},"Triangle (bilinear)"),Object(a.b)("option",{value:"hqx"},"hqx (pixel art)"),Object(a.b)("option",{value:"browser-pixelated"},"Browser pixelated"),Object(a.b)("option",{value:"browser-low"},"Browser low quality"),Object(a.b)("option",{value:"browser-medium"},"Browser medium quality"),Object(a.b)("option",{value:"browser-high"},"Browser high quality"))),Object(a.b)("label",{class:G.optionTextFirst},"Preset:",Object(a.b)(vt,{value:this.getPreset(),onChange:this.onPresetChange},Ft.map(t=>Object(a.b)("option",{value:t},100*t,"%")),Object(a.b)("option",{value:"custom"},"Custom"))),Object(a.b)("label",{class:G.optionTextFirst},"Width:",Object(a.b)("input",{required:!0,class:G.textField,name:"width",type:"number",min:"1",value:""+t.width,onInput:this.onWidthInput})),Object(a.b)("label",{class:G.optionTextFirst},"Height:",Object(a.b)("input",{required:!0,class:G.textField,name:"height",type:"number",min:"1",value:""+t.height,onInput:this.onHeightInput})),Object(a.b)(gt,null,Ht(t)?Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"premultiply",checked:t.premultiply,onChange:this.onChange}),"Premultiply alpha channel"):null,Ht(t)?Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"linearRGB",checked:t.linearRGB,onChange:this.onChange}),"Linear RGB"):null),Object(a.b)("label",{class:G.optionInputFirst},Object(a.b)(dt,{name:"maintainAspect",checked:n,onChange:Ot(this,"maintainAspect")}),"Maintain aspect ratio"),Object(a.b)(gt,null,n?null:Object(a.b)("label",{class:G.optionTextFirst},"Fit method:",Object(a.b)(vt,{name:"fitMethod",value:t.fitMethod,onChange:this.onChange},Object(a.b)("option",{value:"stretch"},"Stretch"),Object(a.b)("option",{value:"contain"},"Contain")))))}}qt([c.b],Wt.prototype,"onChange",null),qt([c.b],Wt.prototype,"onWidthInput",null),qt([c.b],Wt.prototype,"onHeightInput",null),qt([c.b],Wt.prototype,"onPresetChange",null);const Ut="identity",$t="Original image",Nt={},Vt="png",Yt="OptiPNG",Gt="image/png",Jt="png",Zt={level:2};var Xt=n(22),Qt=n(23),Kt=n(24),te=n(25),ee=n(26),ne=n(27),oe=n(28),ie=n(29);const se={[Ut]:s,[Vt]:r,[at]:o,[Et]:i,[Xt.type]:Xt,[Qt.type]:Qt,[Kt.type]:Kt,[oe.type]:oe,[te.type]:te,[ee.type]:ee,[ne.type]:ne,[ie.type]:ie},re=Array.from(Object.values(se)),ae=Promise.resolve().then(async()=>{const t={};return await Promise.all(re.map(async e=>{const n=!("featureTest"in e)||await e.featureTest();t[e.type]=n})),t});var ce=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};const le={[Ut]:void 0,[Vt]:rt,[at]:yt,[Et]:It,[Xt.type]:void 0,[Qt.type]:Ct,[Kt.type]:Rt,[oe.type]:void 0,[te.type]:void 0,[ee.type]:void 0,[ne.type]:void 0,[ie.type]:void 0};class he extends a.a{constructor(){super(),this.state={encoderSupportMap:void 0},ae.then(t=>this.setState({encoderSupportMap:t}))}onEncoderTypeChange(t){const e=t.currentTarget.value;this.props.onEncoderTypeChange(e)}onPreprocessorEnabledChange(t){const e=t.currentTarget,n=e.name.split(".")[0];this.props.onPreprocessorOptionsChange($(this.props.preprocessorState,`${n}.enabled`,e.checked))}onQuantizerOptionsChange(t){this.props.onPreprocessorOptionsChange(U(this.props.preprocessorState,"quantizer",t))}onResizeOptionsChange(t){this.props.onPreprocessorOptionsChange(U(this.props.preprocessorState,"resize",t))}render({source:t,encoderState:e,preprocessorState:n,onEncoderOptionsChange:o},{encoderSupportMap:i}){const s=le[e.type];return Object(a.b)("div",{class:G.optionsScroller},Object(a.b)(gt,null,e.type===Ut?null:Object(a.b)("div",null,Object(a.b)("h3",{class:G.optionsTitle},"Edit"),Object(a.b)("label",{class:G.sectionEnabler},Object(a.b)(dt,{name:"resize.enable",checked:!!n.resize.enabled,onChange:this.onPreprocessorEnabledChange}),"Resize"),Object(a.b)(gt,null,n.resize.enabled?Object(a.b)(Wt,{isVector:Boolean(t&&t.vectorImage),inputWidth:t?t.processed.width:1,inputHeight:t?t.processed.height:1,options:n.resize,onChange:this.onResizeOptionsChange}):null),Object(a.b)("label",{class:G.sectionEnabler},Object(a.b)(dt,{name:"quantizer.enable",checked:!!n.quantizer.enabled,onChange:this.onPreprocessorEnabledChange}),"Reduce palette"),Object(a.b)(gt,null,n.quantizer.enabled?Object(a.b)(Bt,{options:n.quantizer,onChange:this.onQuantizerOptionsChange}):null))),Object(a.b)("h3",{class:G.optionsTitle},"Compress"),Object(a.b)("section",{class:`${G.optionOneCell} ${G.optionsSection}`},i?Object(a.b)(vt,{value:e.type,onChange:this.onEncoderTypeChange,large:!0},re.filter(t=>i[t.type]).map(t=>Object(a.b)("option",{value:t.type},t.label))):Object(a.b)(vt,{large:!0},Object(a.b)("option",null,"Loading…"))),Object(a.b)(gt,null,s?Object(a.b)(s,{options:e.options,onChange:o}):null))}}ce([c.b],he.prototype,"onEncoderTypeChange",null),ce([c.b],he.prototype,"onPreprocessorEnabledChange",null),ce([c.b],he.prototype,"onQuantizerOptionsChange",null),ce([c.b],he.prototype,"onResizeOptionsChange",null);const ue=5;class pe{constructor(){this._entries=[]}add(t){if(t.encoderState.type===Ut)throw Error("Cannot cache identity encodes");this._entries.unshift(t),this._entries.length>ue&&this._entries.pop()}match(t,e,n){const o=this._entries.findIndex(o=>{if(o.sourceData!==t)return!1;if(o.encoderState.type!==n.type)return!1;for(const t in e)if(!Object(l.p)(e[t],o.preprocessorState[t]))return!1;return!!Object(l.p)(n.options,o.encoderState.options)});if(-1===o)return;const i=this._entries[o];return 0!==o&&(this._entries.splice(o,1),this._entries.unshift(i)),{data:i.data,preprocessed:i.preprocessed,file:i.file}}}const de={quantizer:Object.assign({enabled:!1},{zx:0,maxNumColors:256,dither:1}),resize:Object.assign({enabled:!1},{width:1,height:1,method:"lanczos3",fitMethod:"stretch",premultiply:!0,linearRGB:!0})};var be=n(41),ge=n.n(be);const fe=Object(l.d)(ge.a);async function me(t,e){const n=await Object(l.q)(t);try{return"image/webp"!==n||await fe?await Object(l.m)(t):await e.webpDecode(t)}catch(o){throw Error("Couldn't decode image")}}var ve=n(42),Oe=n(52);const ye="open-one-only";function _e(t){const e=t.closest("multi-panel > *, a, button");if(e&&e.classList.contains(Oe.panelHeading))return e}async function je(t){const e=t.nextElementSibling;if(!e)return;const n=e.getBoundingClientRect().height;t.removeAttribute("content-expanded"),e.setAttribute("aria-expanded","false"),await null,await Object(l.r)(e,{from:n,to:0,duration:300}),e.style.height=""}customElements.define("multi-panel",class extends HTMLElement{static get observedAttributes(){return[ye]}constructor(){super(),this.addEventListener("click",this._onClick),this.addEventListener("keydown",this._onKeyDown),new MutationObserver(()=>this._childrenChange()).observe(this,{childList:!0})}connectedCallback(){this._childrenChange()}attributeChangedCallback(t,e,n){t===ye&&null===n&&this._closeAll({exceptFirst:!0})}_onClick(t){const e=_e(t.target);e&&this._toggle(e)}_onKeyDown(t){const e=document.activeElement,n=_e(e);if(!n)return;if(e!==n)return;if(t.altKey)return;let o;switch(t.key){case"ArrowLeft":case"ArrowUp":o=this._prevHeading();break;case"ArrowRight":case"ArrowDown":o=this._nextHeading();break;case"Home":o=this._firstHeading();break;case"End":o=this._lastHeading();break;case"Enter":case" ":case"Spacebar":this._toggle(n);break;default:return}t.preventDefault(),o&&(e.setAttribute("tabindex","-1"),o.setAttribute("tabindex","0"),o.focus())}_toggle(t){t&&(t.hasAttribute("content-expanded")?je(t):(this.openOneOnly&&this._closeAll(),async function(t){const e=t.nextElementSibling;if(!e)return;const n=e.getBoundingClientRect().height;t.setAttribute("content-expanded",""),e.setAttribute("aria-expanded","true");const o=e.getBoundingClientRect().height;await null,await Object(l.r)(e,{from:n,to:o,duration:300}),e.style.height=""}(t)))}_closeAll(t={}){const{exceptFirst:e=!1}=t;let n=[...this.children].filter(t=>t.matches("[content-expanded]"));e&&(n=n.slice(1));for(const o of n)je(o)}_childrenChange(){let t=!1,e=this.firstElementChild;for(;e;){const n=e.nextElementSibling,o=Math.random().toString(36).substr(2,9);if(!n){console.error("<multi-panel> requires an even number of element children.");break}e.classList.remove(Oe.panelContent),n.classList.remove(Oe.panelHeading),e.removeAttribute("aria-expanded"),e.removeAttribute("content-expanded"),n.removeAttribute("tabindex"),e.classList.add(Oe.panelHeading),n.classList.add(Oe.panelContent),e.id=`panel-heading-${o}`,e.setAttribute("aria-controls",`panel-content-${o}`),n.id=`panel-content-${o}`,n.setAttribute("aria-labelledby",`panel-heading-${o}`),"0"===e.getAttribute("tabindex")?t=!0:e.setAttribute("tabindex","-1"),n.setAttribute("aria-expanded",e.hasAttribute("content-expanded")?"true":"false"),e=n.nextElementSibling}!t&&this.firstElementChild&&this.firstElementChild.setAttribute("tabindex","0"),this.openOneOnly&&this._closeAll({exceptFirst:!0})}_prevHeading(){if(this.firstElementChild===document.activeElement)return this.firstElementChild;const t=document.activeElement.previousElementSibling;return t?t.previousElementSibling:void 0}_nextHeading(){const t=document.activeElement.nextElementSibling;if(t)return t.nextElementSibling}_firstHeading(){return this.firstElementChild}_lastHeading(){const t=this.lastElementChild;if(t&&t.classList.contains(Oe.panelHeading))return t;const e=this.lastElementChild;return e?e.previousElementSibling:void 0}get openOneOnly(){return this.hasAttribute(ye)}set openOneOnly(t){t?this.setAttribute(ye,""):this.removeAttribute(ye)}});var we=n(32),Ce=n(53);class Ee extends a.a{render({blob:t,compareTo:e}){let n;if(e){const o=t.size/e.size;if(o>1){const t=Math.round(100*(o-1))+"%";n=Object(a.b)("span",{class:`${we.sizeDelta} ${we.sizeIncrease}`},"0%"===t?"slightly":t," bigger")}else if(o<1){const t=Math.round(100*(1-o))+"%";n=Object(a.b)("span",{class:`${we.sizeDelta} ${we.sizeDecrease}`},"0%"===t?"slightly":t," smaller")}else n=Object(a.b)("span",{class:we.sizeDelta},"no change")}return Object(a.b)("span",null,Ce(t.size)," ",n)}}n(7);var xe=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};const Pe={"stack-right":we.stackRight,"download-right":we.downloadRight,"download-left":we.downloadLeft},Se=500;class ke extends a.a{constructor(){super(...arguments),this.state={showLoadingState:!1},this.loadingTimeoutId=0}componentDidUpdate(t,e){t.loading&&!this.props.loading?(clearTimeout(this.loadingTimeoutId),this.setState({showLoadingState:!1})):!t.loading&&this.props.loading&&(this.loadingTimeoutId=self.setTimeout(()=>this.setState({showLoadingState:!0}),Se))}onCopyToOtherClick(t){t.preventDefault(),this.props.onCopyToOtherClick()}onDownload(){const t=Math.round(this.props.source.file.size/1024),e=Math.round(this.props.imageFile.size/1024),n=Math.round(e/t*1e3);ga("send","event","compression","download",{metric1:t,metric2:e,metric3:n})}render({source:t,imageFile:e,downloadUrl:n,children:o,copyDirection:i,buttonPosition:s},{showLoadingState:r}){return Object(a.b)("div",{class:`${we.results} ${Pe[s]}`},Object(a.b)("div",{class:we.resultData},o[0]?Object(a.b)("div",{class:we.resultTitle},o):null,!e||r?"Working…":Object(a.b)(Ee,{blob:e,compareTo:t&&e!==t.file?t.file:void 0})),Object(a.b)("button",{class:we.copyToOther,title:"Copy settings to other side",onClick:this.onCopyToOtherClick},Object(a.b)(q,{class:we.copyIcon,copyDirection:i})),Object(a.b)("div",{class:we.download},n&&e&&Object(a.b)("a",{class:`${we.downloadLink} ${r?we.downloadLinkDisable:""}`,href:n,download:e.name,title:"Download",onClick:this.onDownload},Object(a.b)(k,{class:we.downloadIcon})),r&&Object(a.b)("loading-spinner",{class:we.spinner})))}}xe([c.b],ke.prototype,"onCopyToOtherClick",null),xe([c.b],ke.prototype,"onDownload",null);const ze={rotate:{rotate:0}};n.d(e,"SquooshStartEventType",function(){return Te}),n.d(e,"SquooshStartEvent",function(){return Re}),n.d(e,"SquooshSideEvent",function(){return Le}),n.d(e,"default",function(){return Fe});var Te,Ae=function(t,e,n,o){var i,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(e,n,r):i(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r};function Ie(t,e){t instanceof e||Object.setPrototypeOf(t,e.prototype)}!function(t){t.START="squoosh:start"}(Te||(Te={}));class Re extends Event{constructor(t){super(Te.START,t),Ie(this,Re)}}class Le extends Event{constructor(t,e){super(t,e),Ie(this,Le),this.side=e.side,this.error=e.error}}async function Me(t,e,n){let o=t;return 0!==e.rotate.rotate&&(o=await n.rotate(o,e.rotate)),o}function Be(t,e){let n=Object.assign({},t);for(const o of[0,1]){const e=t.sides[o].downloadUrl;e&&URL.revokeObjectURL(e),n=U(t,`sides.${o}`,{preprocessed:void 0,file:void 0,downloadUrl:void 0,data:void 0,encodedSettings:void 0})}return n}const De=["Top","Bottom"],He=["download-left","download-right"],qe=document.title;class Fe extends a.a{constructor(t){super(t),this.widthQuery=window.matchMedia("(max-width: 599px)"),this.state={source:void 0,loading:!1,loadingCounter:0,sides:[{latestSettings:{preprocessorState:de,encoderState:{type:Ut,options:Nt}},loadingCounter:0,loadedCounter:0,loading:!1},{latestSettings:{preprocessorState:de,encoderState:{type:at,options:ut}},loadingCounter:0,loadedCounter:0,loading:!1}],mobileView:this.widthQuery.matches},this.encodeCache=new pe,this.leftProcessor=new ve.a,this.rightProcessor=new ve.a,this.updateImageTimeoutIds=[void 0,void 0],this.widthQuery.addListener(this.onMobileWidthChange),this.updateFile(t.file),n.e(1).then(n.bind(null,57)).then(({mainAppLoaded:t})=>t())}onMobileWidthChange(){this.setState({mobileView:this.widthQuery.matches})}onEncoderTypeChange(t,e){this.setState({sides:$(this.state.sides,`${t}.latestSettings.encoderState`,{type:e,options:se[e].defaultOptions})})}onPreprocessorOptionsChange(t,e){this.setState({sides:$(this.state.sides,`${t}.latestSettings.preprocessorState`,e)})}onEncoderOptionsChange(t,e){this.setState({sides:$(this.state.sides,`${t}.latestSettings.encoderState.options`,e)})}updateDocumentTitle(t=""){document.title=t?`${t} - ${qe}`:qe}componentWillReceiveProps(t){t.file!==this.props.file&&this.updateFile(t.file)}componentWillUnmount(){this.updateDocumentTitle()}componentDidUpdate(t,e){const{source:n,sides:o}=this.state,i=!!n!=!!e.source||n&&e.source&&n.processed!==e.source.processed;for(const[s,r]of o.entries()){const t=e.sides[s].latestSettings,n=r.latestSettings.encoderState!==t.encoderState,o=r.latestSettings.preprocessorState!==t.preprocessorState;(i||n||o)&&this.queueUpdateImage(s,{skipPreprocessing:!i&&!o})}}async onCopyToOtherClick(t){const e=(t+1)%2,n=this.state.sides[e],o=Object.assign({},this.state.sides[t]);o.file&&(o.downloadUrl=URL.createObjectURL(o.file)),this.setState({sides:$(this.state.sides,e,o)}),"undo"===await this.props.showSnack("Settings copied across",{timeout:5e3,actions:["undo","dismiss"]})&&this.setState({sides:$(this.state.sides,e,n)})}async onInputProcessorChange(t){const e=this.state.source;if(!e)return;const n=e.inputProcessorState.rotate.rotate%180!=t.rotate.rotate%180,o=this.state.loadingCounter+1,i=this.leftProcessor;this.setState({loadingCounter:o,loading:!0,source:$(e,"inputProcessorState",t)}),this.leftProcessor.abortCurrent(),this.rightProcessor.abortCurrent();try{const r=await Me(e.decoded,t,i);if(this.state.loadingCounter!==o)return;let a=Object.assign({},this.state,{loading:!1});if(a=Be(a=$(a,"source.processed",r),a.source),n)for(const t of[0,1]){const e=a.sides[t].latestSettings.preprocessorState.resize;a=U(a,`sides.${t}.latestSettings.preprocessorState.resize`,{width:e.height,height:e.width})}this.setState(a)}catch(s){if("AbortError"===s.name)return;if(console.error(s),this.state.loadingCounter!==o)return;this.props.showSnack("Processing error"),this.setState({loading:!1})}}async updateFile(t){const e=this.state.loadingCounter+1,n=this.leftProcessor;this.setState({loadingCounter:e,loading:!0},this.signalLoadingStart),this.leftProcessor.abortCurrent(),this.rightProcessor.abortCurrent();try{let i,s;t.type.startsWith("image/svg+xml")?(s=await async function(t){const e=new DOMParser,n=await Object(l.c)(t),o=e.parseFromString(n,"image/svg+xml"),i=o.documentElement;if(i.hasAttribute("width")&&i.hasAttribute("height"))return Object(l.b)(t);const s=i.getAttribute("viewBox");if(null===s)throw Error("SVG must have width/height or viewBox");const r=s.split(/\s+/);i.setAttribute("width",r[2]),i.setAttribute("height",r[3]);const a=(new XMLSerializer).serializeToString(o);return Object(l.b)(new Blob([a],{type:"image/svg+xml"}))}(t),i=Object(l.g)(s)):i=await me(t,n);const r=await Me(i,ze,n);if(this.state.loadingCounter!==e)return;let a=Object.assign({},this.state,{source:{decoded:i,file:t,vectorImage:s,processed:r,inputProcessorState:ze},loading:!1});a=Be(a,a.source);for(const t of[0,1])a=U(a,`sides.${t}.latestSettings.preprocessorState.resize`,{width:r.width,height:r.height,method:s?"vector":"lanczos3"});this.updateDocumentTitle(t.name),this.setState(a)}catch(o){if("AbortError"===o.name)return;if(console.error(o),this.state.loadingCounter!==e)return;this.props.showSnack("Invalid image"),this.setState({loading:!1})}}queueUpdateImage(t,e={}){clearTimeout(this.updateImageTimeoutIds[t]),this.updateImageTimeoutIds[t]=self.setTimeout(()=>{this.updateImage(t,e).catch(t=>{console.error(t)})},100)}dispatchSideEvent(t,e){document.dispatchEvent(new Le(t,e))}signalLoadingStart(){document.dispatchEvent(new Re)}signalProcessingDone(t){this.dispatchSideEvent("squoosh:done",{side:t})}signalProcessingAbort(t){this.dispatchSideEvent("squoosh:abort",{side:t})}signalProcessingError(t,e){this.dispatchSideEvent("squoosh:error",{side:t,error:new Error(e)})}async updateImage(t,e={}){const{skipPreprocessing:n=!1}=e,{source:o}=this.state;if(!o)return;const i=this.state.sides[t].loadingCounter+1;let s=U(this.state.sides,t,{loadingCounter:i,loading:!0});this.setState({sides:s});const r=s[t],a=r.latestSettings;let l,h,u;const p=this.encodeCache.match(o.processed,a.preprocessorState,a.encoderState),d=0===t?this.leftProcessor:this.rightProcessor;if(d.abortCurrent(),p)({file:l,preprocessed:h,data:u}=p);else try{a.encoderState.type===Ut?(l=o.file,u=o.processed):(h=n&&r.preprocessed?r.preprocessed:await async function(t,e,n){let o=t.processed;if(e.resize.enabled)if("vector"===e.resize.method&&t.vectorImage)o=n.vectorResize(t.vectorImage,e.resize);else if(function(t){return"hqx"===t.method}(e.resize)){o=await n.workerResize(o,e.resize),n.terminateWorker();const t=Object.assign({},e.resize,{method:"catrom"});o=await n.workerResize(o,t)}else o=Ht(e.resize)?await n.workerResize(o,e.resize):n.resize(o,e.resize);return e.quantizer.enabled&&(o=await n.imageQuant(o,e.quantizer)),o}(o,a.preprocessorState,d),l=await async function(t,e,n,o){const i=await(()=>{switch(e.type){case Vt:return o.optiPngEncode(t,e.options);case at:return o.mozjpegEncode(t,e.options);case Et:return o.webpEncode(t,e.options);case Xt.type:return o.browserPngEncode(t);case Qt.type:return o.browserJpegEncode(t,e.options);case Kt.type:return o.browserWebpEncode(t,e.options);case te.type:return o.browserGifEncode(t);case ee.type:return o.browserTiffEncode(t);case ne.type:return o.browserJp2Encode(t);case oe.type:return o.browserBmpEncode(t);case ie.type:return o.browserPdfEncode(t);default:throw Error(`Unexpected encoder ${JSON.stringify(e)}`)}})(),s=se[e.type];return new c.a([i],n.replace(/.[^.]*$/,`.${s.extension}`),{type:s.mimeType})}(h,a.encoderState,o.file.name,d),u=await me(l,d),this.encodeCache.add({data:u,preprocessed:h,file:l,sourceData:o.processed,encoderState:a.encoderState,preprocessorState:a.preprocessorState}))}catch(g){if("AbortError"===g.name)return void this.signalProcessingAbort(t);const e=`Processing error (type=${a.encoderState.type}): ${g}`;throw this.signalProcessingError(t,e),this.props.showSnack(e),g}const b=this.state.sides[t];i<b.loadedCounter||(b.downloadUrl&&URL.revokeObjectURL(b.downloadUrl),s=U(this.state.sides,t,{file:l,data:u,preprocessed:h,downloadUrl:URL.createObjectURL(l),loading:s[t].loadingCounter!==i,loadedCounter:i,encodedSettings:a}),this.setState({sides:s},()=>this.signalProcessingDone(t)))}render({onBack:t},{loading:e,sides:n,source:o,mobileView:i}){const[s,r]=n,[c,l]=n.map(t=>t.data),u=n.map((t,e)=>Object(a.b)(he,{source:o,mobileView:i,preprocessorState:t.latestSettings.preprocessorState,encoderState:t.latestSettings.encoderState,onEncoderTypeChange:this.onEncoderTypeChange.bind(this,e),onEncoderOptionsChange:this.onEncoderOptionsChange.bind(this,e),onPreprocessorOptionsChange:this.onPreprocessorOptionsChange.bind(this,e)})),p=i?["down","up"]:["right","left"],d=n.map((t,n)=>Object(a.b)(ke,{downloadUrl:t.downloadUrl,imageFile:t.file,source:o,loading:e||t.loading,copyDirection:p[n],onCopyToOtherClick:this.onCopyToOtherClick.bind(this,n),buttonPosition:i?"stack-right":He[n]},i?[Object(a.b)(B,{class:h.expandIcon,key:"expand-icon"}),`${De[n]} (${se[t.latestSettings.encoderState.type].label})`]:null)),b=s.encodedSettings||s.latestSettings,g=r.encodedSettings||r.latestSettings,f=b.preprocessorState.resize.enabled&&"contain"===b.preprocessorState.resize.fitMethod,m=g.preprocessorState.resize.enabled&&"contain"===g.preprocessorState.resize.fitMethod;return Object(a.b)("div",{class:h.compress},Object(a.b)(Y,{source:o,mobileView:i,leftCompressed:c,rightCompressed:l,leftImgContain:f,rightImgContain:m,onBack:t,inputProcessorState:o&&o.inputProcessorState,onInputProcessorChange:this.onInputProcessorChange}),i?Object(a.b)("div",{class:h.options},Object(a.b)("multi-panel",{class:h.multiPanel,"open-one-only":!0},d[0],u[0],d[1],u[1])):[Object(a.b)("div",{class:h.options,key:"options0"},u[0],d[0]),Object(a.b)("div",{class:h.options,key:"options1"},u[1],d[1])])}}Ae([c.b],Fe.prototype,"onMobileWidthChange",null),Ae([c.b],Fe.prototype,"onInputProcessorChange",null),Ae([c.b],Fe.prototype,"updateFile",null),Ae([c.b],Fe.prototype,"dispatchSideEvent",null),Ae([c.b],Fe.prototype,"signalLoadingStart",null),Ae([c.b],Fe.prototype,"signalProcessingDone",null),Ae([c.b],Fe.prototype,"signalProcessingAbort",null),Ae([c.b],Fe.prototype,"signalProcessingError",null)},function(t,e,n){"use strict";var o=n(19);function i(t,e,n,o){const i=n/o;if(i>t/e){const n=t/i;return{sw:t,sh:n,sx:0,sy:(e-n)/2}}const s=e*i;return{sh:e,sw:s,sx:(t-s)/2,sy:0}}function s(t,e){let n=0,s=0,r=t.width,a=t.height;return"contain"===e.fitMethod&&({sx:n,sy:s,sw:r,sh:a}=i(r,a,e.width,e.height)),Object(o.n)(t,n,s,r,a,e.width,e.height,e.method.slice("browser-".length))}function r(t,e){let n=0,s=0,r=t.width,a=t.height;return"contain"===e.fitMethod&&({sx:n,sy:s,sw:r,sh:a}=i(r,a,e.width,e.height)),Object(o.g)(t,{sx:n,sy:s,sw:r,sh:a,width:e.width,height:e.height})}n.d(e,"a",function(){return s}),n.d(e,"b",function(){return r})}])]);
//# sourceMappingURL=main-app.edd51.js.map